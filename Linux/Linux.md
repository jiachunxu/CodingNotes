# Linux

# Linux 主要的发行版

- Ubuntu
- RedHat
- CentOS
- Debain
- Fedora
- SUSE
- OpenSUSE

# Xshell Xftp

[Xshell Xftp 家庭/学校免费版 地址](https://www.netsarang.com/en/free-for-home-school/)

# VI VIM

## 常用三种模式

- 正常模式
  - 打开文本文件默认模式
- 插入模式
  - 默认模式按下 `i` 进入插入模式, 编辑文件
- 命令模式
  - 输入完成后, 按 `esc` 输入 `:` 进入命令模式, 例如: 输入 `:wq`,保存并退出

## vi 和 vim 快捷键

- yy : 复制当前一行 5yy : 向下复制5行
- dd : 删除当前行 5dd : 向下删除5行
- 查找单词 命令模式下 `/单词` ,回车 按 `n` 查找下一个
- 设置行号 命令模式下 `:set nu` ,取消行号 `:set nonu`, 也可以操作配置文件 `/etc/vim/vimrc`
- `G` 调到最后一行, `gg` 跳到第一行
- 撤销最近操作 `u`

# 开机、重启和用户登录注销

- `shutdown –h now`   立刻关机
- `shutdown  now`  立刻关机
- `shutdown -h 1` 1分钟后会关机
- `shutdown –r now` 立刻重启
- `halt`   关机
- `reboot` 重启
- `sync`   把内存的数据同步到磁盘.

## 用户登录和注销

- 切换用户 : `su - 用户名`
  - 从权限高的用户切换到权限低的用户，不需要输入密码，反之需要。
  - 当需要返回到原来用户时，使用 `exit | logout` 指令
- 注销用户 : `logout`
  - logout 注销指令在图形运行级别无效

# 用户管理

## 添加用户

- `useradd 用户名`
  - 当创建用户成功后，会自动的创建和用户同名的家目录
  - 也可以通过 `useradd -d 指定目录 新的用户名`，给新创建的用户指定家目录

## 指定/修改密码

- `passwd 用户名`

## 删除用户

- `userdel 用户名`
  - 默认保留用户家目录
  - 删除用户以及用户主目录 `userdel -r 用户名`

## 查询用户信息指令

- `id 用户名`
- `whoami` : 查看当前用户

## 用户组

### 新增组

- `groupadd 组名`

### 删除组

- `groupdel 组名`

### 修改用户的组

- `usermod –g 用户组 用户名`
- `usermod –d 目录名 用户名` (改变该用户登陆的初始目录。**特别说明**：用户需要有进入到新目录的权限)

> 添加用户时指定用户组
>
> - `useradd –g 用户组 用户名`

## 用户和组相关文件

- `/etc/passwd`

> 用户（user）的配置文件，记录用户的各种信息
>
> 每行的含义：用户名:口令:用户标识号:组标识号:注释性描述:主目录:登录 Shell

- `/etc/shadow`

> 口令的配置文件
>
> 每行的含义：登录名:加密口令:最后一次修改时间:最小时间间隔:最大时间间隔:警告时间:不活动时间:失效时间:标志

- `/etc/group`

> 组(group)的配置文件，记录 Linux 包含的组的信息
>
> 每行含义：组名:口令:组标识号:组内用户列表

# 运行级别

- 0 ：关机
- 1 ：单用户【找回丢失密码】
- 2 ：多用户状态没有网络服务
- 3 ：多用户状态有网络服务
- 4 ：系统未使用保留给用户
- 5 ：图形界面
- 6 ：系统重启

**常用运行级别是 3 和 5 ，也可以指定默认运行级别**

## 指定运行级别

- `init [0123456]`

## 说明

> 在 centos7 以前， `/etc/inittab` 文件中

- `multi-user.target`: analogous to runlevel 3
- `graphical.target`: analogous to runlevel 5

**获取当前运行级别**

- `systemctl get-default`

**设置运行级别**

- `systemctl set-default TARGET.target`

# 帮助指令

## man 获得帮助信息

**基本语法**：`man [命令或配置文件]`（获得帮助信息）

## help 指令

**基本语法**：`help 命令` （获得 shell 内置命令的帮助信息）

# 常用命令

## 文件目录类

### pwd

> 获取当前工作目录 (当前所在目录)

### ls

> 查看指定目录下的文件或文件夹
>
> - `ls [选项] [目录或是文件]`

**常用选项**

- `-a` ：显示当前目录所有的文件和目录，包括隐藏的。
- `-l` ：以列表的方式显示信息

### cd

> 切换工作目录
>
> - `cd [参数] (功能描述：切换到指定目录)`

---

- `cd ~` 或者 `cd` ：回到自己的家目录, 比如 root 用户 ， `cd ~` 是回到 `/root`
- `cd ..` 回到当前目录的上一级目录

### mkdir

> 创建目录 | 文件夹
>
> - `mkdir [选项] 要创建的目录`

**常用选项**

- `-p` ：创建多级目录

### rmdir

> 删除指定空目录
>
> - `rmdir [选项] 要删除的空目录`

> rmdir 删除的是空目录，如果目录下有内容时无法删除的。
>
> 提示：如果需要删除非空目录，需要使用 rm -rf 要删除的目录
>
> 比如： `rm -rf /home/animal`

### touch

> 创建文件
>
> - `touch 文件名称`

### cp

> 复制文件|目录 到指定 目录
>
> - `cp [选项] source dest`

**常用选项**

- `-r` : 递归复制整个文件夹

### rm

> 删除文件夹 | 文件
>
> - `rm [选项] 要删除的文件或目录`

**常用选项**

- `-r` ：递归删除整个文件夹
- `-f` ： 强制删除不提示

### mv

> 移动文件 或 重命名
>
> - `mv oldNameFile newNameFile` (功能描述：重命名)
>
> - `mv /temp/movefile /targetFolder` (功能描述：移动文件)

### cat

> 查看文本文件
>
> - `cat [选项] 要查看的文件`

**常用选项**

- `-n` ：显示行号

### more

> more 指令是一个基于 VI 编辑器的文本过滤器，它以全屏幕的方式按页显示文本文件的内容。
>
> more 指令中内置了若 干快捷键(交互的指令)
>
> - `more 要查看的文件`

**操作说明**

| 操作       | 功能说明       |
|----------|------------|
| 空格       | 向下翻一页      |
| 回车       | 向下翻一行      |
| q        | 退出         |
| Ctrl + F | 向下滚一屏      |
| Ctrl + B | 返回上一屏      |
| `:f`     | 输出文件名和当前行号 |

### less

> less 指令用来分屏查看文件内容，它的功能与 more 指令类似，但是比 more 指令更加强大，支持各种显示终端。less
> 指令在显示文件内容时，并不是一次将整个文件加载之后才显示，而是根据显示需要加载内容，对于显示大型文件具有 较高的效率。
>
> - `less 要查看的文件`

**操作说明**

| 操作        | 功能说明                |
|-----------|---------------------|
| 空格        | 向下一页                |
| page down | 向下一页                |
| page up   | 向上一页                |
| /字符串      | 向下搜索'字符串';n 向下,N 向上 |
| ?字符串      | 向上搜索'字符串';n 向下,N 向上 |
| q         | 退出 less             |

### echo

> 输出到控制台
>
> - `echo [选项] [输出内容]`

**例如**

- `echo $PATH`
- `echo $HOSTNAME`

### head

> 于显示文件的开头部分内容，默认情况下 head 指令显示文件的前 10 行内容
>
> - `head -n 5 文件` 查看文件头 5 行内容

### tail

> tail 用于输出文件中尾部的内容，默认情况下 tail 指令显示文件的前 10 行内容。
>
> - `tail -n 5 文件` 查看文件尾 5 行内容
> - `tail -f 文件` 实时追踪该文档的所有更新

### `>` 和 `>>`

- `> 输出重定向`
- `>> 追加`

- `ls -l >文件` 列表的内容写入文件 a.txt 中（覆盖写）
- `ls -al >>文件` （列表的内容追加到文件 aa.txt 的末尾
- `cat 文件 1 > 文件 2` 将文件 1 的内容覆盖到文件 2
- `echo "内容">> 文件` (追加)

### ln

> 软链接也称为符号链接，类似于 windows 里的快捷方式，主要存放了链接其他文件的路径
>
> - `ln -s [原文件或目录] [软链接名]`

## history

> 查看已经执行过历史命令,也可以执行历史指令
>
> - `history 10 ` 显示最近使用过的 10 个指令。
> - `!5` 执行历史编号为 5 的指令

## 时间日期类

### date

> 显示当前时间

- `date +%Y`（显示当前年份）
- `date +%m`（显示当前月份）
- `date +%d` （显示当前是哪一天）
- `date "+%Y-%m-%d %H:%M:%S`"（显示年月日时分秒）

- `date -s “2020-11-03 20:02:10”` 设置系统当前时间 ，2020-11-03 20:02:10

### cal

> 参看日历
>
> - `cal [选项]` (不加选项，显示本月日历)
> - `cal 2020` (显示 2020 年日历)

## 搜索查找类

### find

> find 指令将从指定目录向下递归地遍历其各个子目录，将满足条件的文件或者目录显示在终端。
>
> - `find [搜索范围] [选项]`

**选项**

| 选项    | 功能                                         |
|-------|--------------------------------------------|
| -name | 按文件名查找                                     |
| -user | 查找指定用户所有文件                                 |
| -size | 按文件大小查询 <br/>(+n 大于 -n 小于 n 等于, 单位有 k,M,G) |

**例子**

- `find /home -name hello.txt`
- `find /opt -user nobody`
- `find / -size +200M`

### locate

> locate 指令可以快速定位文件路径。locate 指令利用事先建立的系统中所有文件名称及路径的 locate 数据库实现快速
> 定位给定的文件。locate 指令无需遍历整个文件系统，查询速度较快。
>
> - `locate 搜索文件`
>
> **特别说明**
>
> 由于 locate 指令基于数据库进行查询，所以第一次运行前，必须使用 updatedb 指令创建 locate 数据库。

### which

> 可以查看某个指令在哪个目录下
>
> `which ls` 参看 ls 命令所在目录

### whereis

### grep 和 管道 |

> grep 过滤查找 ， 管道符，“|”，表示将前一个命令的处理结果输出传递给后面的命令处理
>
> - `grep [选项] 查找内容 源文件`

**常用选项**

| 选项  | 功能    |
|-----|-------|
| -n  | 显示行号  |
| -i  | 忽略大小写 |

**例子**

- `cat /home/hello.txt | grep "yes"`
- `grep -n "yes" /home/hello.txt`

## 压缩和解压类

### gzip / gunzip

> gzip 用于压缩文件， gunzip 用于解压的
>
> - `gzip 文件` (压缩文件，只能将文件压缩为*.gz 文件)
> - `gunzip 文件.gz` (解压缩文件命令)

### zip / unzip

> zip 用于压缩文件， unzip 用于解压的
>
> - `zip [选项] XXX.zip 将要压缩的内容`（压缩文件和目录的命令）
> - `unzip [选项] XXX.zip` (解压缩文件)

** zip 常用选项**

| -r  | 递归压缩,压缩目录 |
|-----|-----------|

** unzip 常用选项**

| -d<目录> | 指定解压后文件的存放目录 |
|--------|--------------|

**例子**
> 将 myhome.zip 解压到 /opt/tmp 目录下
> - `unzip -d /opt/tmp /home/myhome.zip`
>
>
> 将 /home 下的 所有文件/文件夹进行压缩成 myhome.zip
> - `zip -r myhome.zip /home/`

### tar

> 是打包指令，最后打包后的文件是 .tar.gz 的文件
>
> - `tar [选项] XXX.tar.gz 打包的内容` (打包目录，压缩后的文件格式.tar.gz)

**选项**

| 选项  | 功能         |
|-----|------------|
| -c  | 产生打包文件     |
| -v  | 显示详细信息     |
| -f  | 指定压缩后文件名   |
| -z  | 打包同时压缩     |
| -x  | 解包 .tar 文件 |
| -C  | 指定解压缩目录    |

**例子**

> 压缩多个文件，将 /home/pig.txt 和 /home/cat.txt 压缩成 pc.tar.gz
> - `tar -zcvf pc.tar.gz /home/pig.txt /home/cat.txt`
>
> 将/home 的文件夹 压缩成 myhome.tar.gz
> - `tar -zcvf myhome.tar.gz /home/`
>
> 将myhome.tar.gz 解压到 /opt/tmp2目录下
> - `tar -zxvf /home/myhome.tar.gz -C /opt/tmp2`

# 组管理 和 权限管理

## 文件 / 目录 所在组

> 当某个用户创建了一个文件后，这个文件的所在组就是该用户所在的组(默认)。

## 查看文件/目录所在组

- `ls -alh`

## 修改文件所有者

- `chown 用户名 文件名`

## 修改文件/目录所在的组

- `chgrp 组名 文件名`

## 权限的基本介绍

> ls -l 中显示的内容如下
>
> -rwxrw-r-- 1 root root 1213 Feb 2 09:39 abc

**0-9 位说明**

> 第 0 位确定文件类型(d, - , l , c , b)
> - `l` 是链接
> - `d` 是目录
> - `c` 是字符设备文件 鼠标, 键盘
> - `b` 是块设备 比如 : 硬盘
>
> 第 1-3 位确定所有者（该文件的所有者）拥有该文件的权限。---User
>
> 第 4-6 位确定所属组（同用户组的）拥有该文件的权限，---Group
>
> 第 7-9 位确定其他用户拥有该文件的权限 ---Other

## rwx 权限详解

### rwx 作用到文件

- [ `r` ] 代表可读 (read): 可以读取,查看
- [ `w` ] 代表可写 (write): 可以修改,但是不代表可以删除该文件
- [ `x` ] 代表可执行 (execute):可以被执行

### rwx 作用到目录

- [ r ] 代表可读 (read): 可以读取，ls 查看目录内容
- [ w ] 代表可写 (write): 可以修改, 对目录内创建+删除+重命名目录
- [ x ] 代表可执行 (execute):可以进入该目录

## 修改权限 chmod

### 第一种方式：+ 、-、= 变更权限

> u:所有者 g:所有组 o:其他人 a:所有人
> - `chmod u=rwx,g=rx,o=x 文件/目录名`
> - `chmod o+w 文件/目录名`
> - `chmod a-x 文件/目录名`

### 第二种方式：通过数字变更权限

> `r=4 w=2 x=1 rwx=4+2+1=7`
>
> `chmod u=rwx,g=rx,o=x 文件目录名`
>
> 相当于
>
> chmod 751 文件/目录名

## 修改文件所有者 chown

> - `chown newowner 文件/目录`
> - ` 改变所有者 chown newowner:newgroup 文件/目录 改变所有者和所在组`
> - `-R` 如果是目录 则使其下所有子文件或目录递归生效

## 修改文件 / 目录所在组 chgrp

- `chgrp newgroup 文件/目录`

# 定时任务

## crond 任务调度 crontab

> `crontab` 进行 定时任务的设置
>
> `crontab [选项]`

**常用选项**

| -e  | 编辑 crontab 定时任务     |
|-----|---------------------|
| -l  | 查询 crontab 任务       |
| -r  | 删除当前用户所有 crontab 任务 |

> 设置任务调度文件：/etc/crontab
>
> 设置个人任务调度。执行 crontab –e 命令。
>
> 输入任务到调度文件 如：*/1 * * * * ls –l /etc/ > /tmp/to.txt
>
> 每小时的每分钟执行 ls –l /etc/ > /tmp/to.txt 命令

**5 个占位符的说明**

| 第一个* | 一小时中第几分钟 | 0-59            |
|------|----------|-----------------|
| 第二个* | 一天中第几小时  | 0-23            |
| 第三个* | 一个月中第几天  | 1-31            |
| 第四个* | 一年中第几月   | 1-12            |
| 第五个* | 一周中星期几   | 0-7 (0和7 都代表周日) |

**特殊符号的说明**

| *   | 任何时间. <br/>第一个 * 代表一个小时每一分钟都执行一次                        |
|-----|---------------------------------------------------------|
| ,   | 不连续时间. <br/> "0 8,12 * * * "<br/> 代表每天8点0分,12点0分, 都执行一次 |
| -   | 连续时间范围 <br/> "0 5 * * 1-6"<br/> 周一到周六凌晨5点0分执行           |
| */n | 每隔多久执行一次<br/>"*/10 * * * * "<br/>每隔10分钟一次               |

### crond 相关指令

- `conrtab –r`：终止任务调度。
- `crontab –l`：列出当前有那些任务调度
- `service crond restart` 重启任务调度

## at 定时任务

> at 命令是一次性定时计划任务，at 的守护进程 atd 会以后台模式运行，检查作业队列来运行。
>
> 默认情况下，atd 守护进程每 60 秒检查作业队列，有作业时，会检查作业运行时间，如果时间与当前时间匹配，则 运行此作业。
>
> at 命令是一次性定时计划任务，执行完一个任务后不再执行此任务了
>
> 在使用 at 命令的时候，一定要保证 atd 进程的启动 ,
>
> 可以使用相关指令来查看 `ps -ef | grep atd` 可以检测 atd 是否在运行

### at 命令格式

> `at [选项] [时间]`
>
> Ctrl + D 结束 at 命令的输入， 输出两次

**选项**

| -m      | 任务结束,给用户发送邮件,即使没有标准输出 |
|---------|-----------------------|
| -I      | atq 别名                |
| -d      | atrm别名                |
| -v      | 显示任务被执行的时间            |
| -c      | 打印任务内容到标准输出           |
| -V      | 显示版本信息                |
| -q 队列   | 使用指定队列                |
| -f 文件   | 从指定文件读入任务,而不是标准输入     |
| -t 时间参数 | 以时间参数的形式提交要运行的任务      |

### at 时间定义

> 接受在当天的 hh:mm（小时:分钟）式的时间指定。假如该时间已过去，那么就放在第二天执行。

> 使用 midnight（深夜），noon（中午），teatime（饮茶时间，一般是下午 4 点）等比较模糊的词语来指定时间。

> 采用 12 小时计时制，即在时间后面加上 AM（上午）或 PM（下午）来说明是上午还是下午。

> 指定命令执行的具体日期，指定格式为 month day（月 日）或 mm/dd/yy（月/日/年）或 dd.mm.yy（日.月.年），指 定的日期必须跟在指定时间的后面。
>
> 例如：04:00 2021-03-1

> 使用相对计时法。指定格式为：now + count time-units ，now 就是当前时间，time-units 是时间单位，这里能够是 minutes
> （分钟）、hours（小时）、days（天）、weeks（星期）。count 是时间的数量，几天，几小时。 例如：now + 5 minutes

> 直接使用 today（今天）、tomorrow（明天）来指定完成命令的时间。

**例子**

- `atrm 编号` 删除已经设置的任务

# 磁盘分区、挂载

> Linux 硬盘分 IDE 硬盘和 SCSI 硬盘，目前基本上是 SCSI 硬盘

> 对于 IDE 硬盘，驱动器标识符为 “hdx~”,其中 “hd” 表明分区所在设备的类型，这里是指 IDE 硬盘了。“x”为盘号（a 为 基本盘，b
> 为基本从属盘，c
> 为辅助主盘，d 为辅助从属盘）,“~”代表分区，前四个分区用数字 1 到 4 表示，
>
> 它们是主分区或扩展分区，从 5 开始就是逻辑分区。例，hda3 表示为第一个 IDE 硬盘上的第三个主分区或扩展分区,hdb2 表示为第二个
> IDE 硬盘上的第二个主分区或扩展分区。

> 对于 SCSI 硬盘则标识为“sdx~”，SCSI 硬盘是用“sd”来表示分区所在设备的类型的，其余则和 IDE 硬盘的表示方法 一样

## 查看所有设备挂载情况

- `lsblk`
- `lsblk -f`

## 分区命令 fdisk

> fdisk /dev/sdb
>
> 开始对/sdb 分区

| m   | 显示命令列表               | 
|-----|----------------------|
| p   | 显示磁盘分区 同 `fdisk –l ` |
| n   | 新增分区                 |
| d   | 删除分区                 |
| w   | 写入并退出                |

**说明** ： 开始分区后输入 n，新增分区，然后选择 p ，分区类型为主分区。两次回车默认剩余全部空间。最后输入 w 写入分区并退出，若不保存退出输入
q

## 格式化磁盘

> 分区命令:`mkfs -t ext4 /dev/sdb1`

## 挂载

> 将一个分区与一个目录联系起来
>
> `mount 设备名称 挂载目录`
>
> 例如：` mount /dev/sdb1 /newdisk`

> `umount 设备名称 或者 挂载目录`
>
> 例如： `umount /dev/sdb1` 或者 `umount /newdisk`

**注意** : 用命令行挂载,重启后会失效

### 永久挂载

> 修改 `/etc/fstab`实现挂载
>
> 添加完成后 执行 `mount –a` 即刻生效

## 磁盘情况查询

- `df -h`

## 查询指定目录的磁盘占用情况

- `du -h`

> 查询指定目录的磁盘占用情况，默认为当前目录

| -s            | 指定目录占用大小汇总    |
|---------------|---------------|
| -h            | 带计量单位         |
| -a            | 含文件           |
| --max-depth=1 | 子目录深度         |
| -c            | 列出明细的同时，增加汇总值 |

**例子**
> 统计 /opt 文件夹下目录的个数，包括子文件夹里的
>
> `ls -lR /opt | grep "^d" | wc -l`

> 以树状显示目录结构 
> 
> `tree 目录`




